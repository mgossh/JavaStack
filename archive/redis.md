# Redis知识点总结

## 数据结构
### 基础
* 字符串
* 散列
* 列表
* 集合
* 有序集合

### 扩展
* HyperLogLog
* 位图
* 地理坐标
* 流

## 持久化
redis持久化的两种方式：

* 快照(RDB):在指定的时间间隔能对你的数据进行快照存储
* 追加文件（AOF）:记录每次对服务器写的操作,当服务器重启的时候会重新执行这些命令来恢复原始的数据。

### 快照
优点

* RDB 是一个非常紧凑（compact）的文件，它保存了 Redis 在某个时间点上的数据集。 这种文件非常适合用于进行备份： 比如说，你可以在最近的 24 小时内，每小时备份一次 RDB 文件，并且在每个月的每一天，也备份一个 RDB 文件。 这样的话，即使遇上问题，也可以随时将数据集还原到不同的版本。
* RDB 非常适用于灾难恢复（disaster recovery）：它只有一个文件，并且内容都非常紧凑，可以（在加密后）将它传送到别的数据中心，或者亚马逊 S3 中。
* RDB 可以最大化 Redis 的性能：父进程在保存 RDB 文件时唯一要做的就是 fork 出一个子进程，然后这个子进程就会处理接下来的所有保存工作，父进程无须执行任何磁盘 I/O 操作。
* RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。

缺点

* 如果你需要尽量避免在服务器故障时丢失数据，那么 RDB 不适合你。 虽然 Redis 允许你设置不同的保存点（save point）来控制保存 RDB 文件的频率， 但是， 因为RDB 文件需要保存整个数据集的状态， 所以它并不是一个轻松的操作。 因此你可能会至少 5 分钟才保存一次 RDB 文件。 在这种情况下， 一旦发生故障停机， 你就可能会丢失好几分钟的数据。
* 每次保存 RDB 的时候，Redis 都要 fork() 出一个子进程，并由子进程来进行实际的持久化工作。 在数据集比较庞大时， fork() 可能会非常耗时，造成服务器在某某毫秒内停止处理客户端； 如果数据集非常巨大，并且 CPU 时间非常紧张的话，那么这种停止时间甚至可能会长达整整一秒。 虽然 AOF 重写也需要进行 fork() ，但无论 AOF 重写的执行间隔有多长，数据的耐久性都不会有任何损失。

### 追加文件

## 集群

## 发布与订阅
发布-订阅模式实现消息队列的缺陷

两个层面考虑：

* 性能：订阅者处理消息不够快，导致消息堆积，从而使输出缓冲区变大，可能导致redis速度变慢(旧版，新版使用了配置来规避)
* 稳定性：断网导致消息丢失

替代方案：使用列表来实现

## 事务


## redis应用
### 实现消息队列
* List的`lpush`/`rpop`命令或者堵塞命令`blpop`/`brpop`
* `发布`-`订阅`模式


## 运维
业界成熟方案

搜狐视频Redis私有云平台：[cachecloud](https://github.com/sohutv/cachecloud)


## 参考资料
* [官网](https://redis.io/)
* [Github](https://github.com/antirez/redis)
* [Redis中文命令参考](http://redisdoc.com/)
* [Redis命令参考](https://redis.io/commands)
* [面试中关于Redis的问题看这篇就够了](https://juejin.im/post/5ad6e4066fb9a028d82c4b66)
* [Redis缓存穿透、缓存雪崩、redis并发问题分析](https://juejin.im/post/5b961172f265da0ab7198f4d)
* [如何高效深入的阅读Redis的源码](https://www.zhihu.com/question/28677076)
* []()
